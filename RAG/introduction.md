# RAG 說明

## 簡介
RAG（Retrieval-Augmented Generation，檢索增強生成）是一種將「資訊檢索」與「生成式 AI 模型」結合的技術，常見於問答系統、聊天機器人、文件助理等應用中。它的核心目的是在生成回答時引用外部資料，以提供更準確、上下文相關的回應。

流程: [用戶問題] => [檢索器找到相關文檔]  => [生成器（LLM）根據文檔與問題回答] => [最終回答]

## 文件進入向量資料庫流程
+ 文件格式轉化器: 所有文件轉化成可接受的文字文件。
+ 分段: 將文件以特定規則分段(比如雙換行符)，可以考慮搭配固定字數或詞數（如每段 500 字）以及滑動視窗，避免句子切斷導致語義不完整。(結構: 文件 => 段落 => 句子)
+ 文字向量化（Text Embedding）: 每個句子轉成向量（數字矩陣），讓電腦可以比較語意相似度。常用模型：
    + OpenAI text-embedding-ada-002
    + HuggingFace 模型（如 sentence-transformers、bge-small-zh)
+ 向量存入資料庫: 將每個向量與對應的原始段落、metadata（例如檔名、標題、頁碼）一起存入向量資料庫。
+ 搭建知識庫: 可以規定一個知識庫實體，事先規定好以下策略，知識庫初始化後不可再更改。
    + 文字分段策略
    + 文字向量化模型
    + metadata 應有欄位
    + metadata 生成器 (通常是 llm)
    + 向量相似度策略
    + 最低可容忍相似度

## 資料選擇策略(以單知識庫為例)
+ 選擇與知識庫同樣的文字向量化模型，轉換成向量後進行搜尋。
+ 搜尋時先依據知識庫 metadata 設定生成 metadata 
+ 先根據 metadata 進行篩選，再根據相似度進行排名
+ 對返回的前 m 名句子，反向收集 1~m 個段落，再取前 n 名
+ 將問題與 n 個段落給 llm
+ 返回結果給使用者，時最好附上資料參考來源。